# Neural Network Based Large Neighborhood Search Algorithm for Ride Hailing Services

## Metadata
- **Link to PDF**: [[[syed2019]_Neural_network_based_large_neighborhood_search_algorithm_for_ride_hailing_services.pdf]]
- **Tags**:
  - #ML-Supervised
  - #PointerNetworks
  - #AttentionMechanismAM
  - #NeuralCombinatorialOptimization
  - #ML-AssistedHeuristics
  - #ML-AssistedLocalSearch
  - #AdaptiveLargeNeighborhoodSearch
  - #LargeNeighborhoodSearch
  - #VRPTW
  - #PDP
  - #DeterministicVRP
- **Relevant**: true
- **Fit Score**: 9
- **State of the Art (SoA) Concepts**:
  - Pointer Network architectures for VRP
  - VRPTW (vehicle routing with time windows) with pickup and delivery
  - Neural-network-based insertion operators within LNS
  - Supervised learning with cost-based loss
- **Performance Evaluation**: no
- **Performance Evaluation Framework**: -

## Abstract
“Ride Hailing (RH) services have become common in many cities. An important aspect of such services is the optimal matching between vehicles and customer requests, which is very close to the classical Vehicle Routing Problem with Time Windows (VRPTW).

With the emergence of new Machine Learning (ML) techniques, many researches have tried to use them for discreet optimization problems. Recently, Pointer Networks (Ptr-Net) have been applied to simpler Vehicle Routing Problem (VRP) with limited applicability. We add fixed slots to their approach to make it applicable to RH scenario. The number of slots can vary without retraining the network. Furthermore, contrary to reinforcement learning in previous work, we use supervise learning for training. We show that the presented architecture has the potential to build good vehicle routes for RH services. Furthermore, looking at the effectiveness of Large Neighbourhood Search (LNS) for VRPTW, we combine the approach with LNS by using the trained network as an insertion operator. We generate examples from New York Taxi data and use the solutions generated from LNS for training. The approach consistently produces good solutions for problems of sizes similar to the ones used during training, and scales well to unseen problems of relatively bigger sizes.”

## Summary
- **Problem & Motivation**
  - Addresses a variant of the Vehicle Routing Problem with Time Windows (VRPTW), specifically suited for Ride Hailing (RH) scenarios where each vehicle can only serve one request at a time.
  - Seeks to optimize route assignments by minimizing vehicle travel time, customer pickup delay, and the number of unserved requests.

- **Key Contribution**
  - Proposes a neural-network-based method that adapts Pointer Networks (Ptr-Net) to VRPTW contexts by adding fixed “slots” for each vehicle, enabling the model to handle multi-vehicle routing with time windows.
  - Demonstrates how supervised learning can replace reinforcement learning approaches to train the Pointer Network for route construction.
  - Integrates the trained network into a Large Neighborhood Search (LNS) framework: the neural model acts as an insertion operator to choose which request to insert and where.

- **Methodology**
  1. **Pairwise Request-Vehicle (RV) Graph**  
     - Constructs a graph for feasible edges among vehicles and requests based on pickup time windows and travel time constraints.
  2. **Large Neighborhood Search (LNS)**  
     - Uses standard remove-and-reinsert heuristics (shaw, random, worst-removal) and a variety of insertion operators (e.g., 2-regret).
     - Incorporates the neural network as an additional insertion operator.
  3. **Neural Network Architecture**  
     - Based on Pointer Networks, specifically designed to handle VRPTW constraints by assigning requests to fixed “slots” on each vehicle route.
     - Features include incremental cost of assignment, count of feasible vehicle choices, and a “regret” value for each request.
     - Trained under a supervised learning paradigm: uses solutions generated by a baseline LNS as “ground truth.”
     - Loss function encourages the model to match or outperform the training solution’s cost while minimizing unassigned requests.

- **Experimental Setup**
  - Uses New York City Taxi trip data to generate vehicles and requests (static snapshots).
  - Trains networks on smaller-scale problems (up to 10 vehicles and 40 requests) and tests on both similar and larger instances (up to 25 vehicles and 100 requests).
  - Compares solutions from:

    1. **Pure neural model** for initial route construction
    2. **Traditional LNS** with standard insertion heuristics
    3. **Hybrid approach** that uses the trained neural model as the LNS insertion operator

- **Results & Findings**
  - The neural model effectively learns how to insert requests, providing solutions of comparable or better quality than classical (greedy or regret-based) insertion heuristics.
  - The model generalizes well to larger problems, maintaining a high solution quality without retraining.
  - Embedding the neural insertion operator into LNS or ALNS consistently outperforms the baseline LNS in terms of solution cost and convergence speed, especially for larger problems.

- **Strengths**
  - Demonstrates a successful supervised learning approach for VRPTW that leverages solutions from a standard heuristic as training data.
  - Scalable architecture: the notion of fixed slots simplifies reusing the same model for bigger instances without extensive modification.
  - Integrates seamlessly with existing LNS frameworks, leveraging machine learning to guide insertion decisions.

- **Weaknesses & Limitations**
  - Does not use widely recognized benchmark sets (e.g., Solomon) for standardized performance comparison.
  - Focuses on supervised learning with solutions of potentially suboptimal quality, which might limit the absolute best solution quality the model can learn.
  - The slot-based approach, while effective, can impose structural constraints on how requests are inserted, potentially missing more flexible route adjustments.

- **Relevance to Deterministic VRP**
  - Addresses a static (deterministic) pickup-and-delivery scenario with time windows, aligning with VRPTW frameworks.
  - Showcases how a neural network (pointer network variant) can be integrated into a local search methodology for deterministic routing.
  - Highly pertinent example of combining ML with classical heuristic techniques to improve solution quality and speed.

- **Potential Impact for Thesis**
  - Illustrates the feasibility and benefits of using a supervised-trained model in synergy with a metaheuristic for VRPTW.
  - Provides an example methodology for bridging classical optimization (LNS) with advanced neural-based decision policies.
  - Emphasizes the importance of carefully designed features (cost, regret, feasible edges) for the network.